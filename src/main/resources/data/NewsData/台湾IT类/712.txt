前面我們介紹了Excel中常用的查找和引用函數，在衆多的查找和引用函數中，VLOOKUP函數是使用最頻繁的，它是創建查詢表的最好工具。如果你去面試的崗位要求中標明瞭熟練Excel的話，面試的時候基本都會問你使用過VLOOKUP嗎？所以我們今天來通過一個實例來學習VLOOKUP。

lookup_value——需要在數據表第一列中進行查找的數值，可爲數值、引用或字符串；

table_array——需要在其中查找數據的數據表，使用對區域或區域名稱的引用；

col_index_num——table_array中將返回的匹配值的列號，col_index_num爲1時，返回table_array第1列的值，col_index_num爲2時，返回table_array第2列的值，以此類推；

range_lookup——爲一邏輯值，指明查找時是精確匹配還是近似匹配。如果爲FALSE或0，則進行精確匹配，如果找不到，則返回錯誤值「#N/A」；如果爲TRUE或1，將查找近似匹配值，參數省略時默認爲近似匹配。

一般企業都會有銷售部門，管理部門的總經理會經常抽查銷售部門的業績情況，他擔心部門經理在每季度彙報工作的時候虛報數據來人爲拔高其部門的工作能力，因此年底時，總經理都會從基層的數據分析師處取得一張員工的銷售記錄表，用來了解實際情況。如下表所示的表格記錄了銷售部門20名應該在過去一年的銷售業績。

雖然只有二十條記錄，但是有時候我們並不想全部看完，而只想隨意抽查某些員工，來了解該部門的業績分佈。該表中列數太多，不便於橫向查閱，因此我們可以爲該表做一個簡單的查詢系統。

第2步：定義區域名稱。在「原表」中，選取區域A1：M21，然後在「公式」下的「定義的名稱」組中單擊「定義名稱」按鈕，在彈出的「新建名稱」對話框中的「名稱」文本框輸入「數據區域」，單擊「確定」。如下圖所示，此步驟是爲了給所選定的區域命名，方便後面的操作中對該區域的引用。

第3步：添加下拉列表。切換至「查詢表」中，選中B2單元格，然後在「數據」下單擊「數據工具」組中的「數據驗證」，在彈出的對話框中設置允許的驗證條件爲「序列」，然後在「來源」文本框引用「原表」中的A2：A21區域，即「員工編號」列，如下圖上所示，此步驟是爲了在B2中創建下拉列表，列表內容就是員工的編號，如下圖下所示。

第4步：輸入查詢公式。在B3單元格輸入公式「=VLOOKUP($B$2,數據區域,2)」，如下圖所示，在該公式中，「$B$2」是需要查詢的員工編號，「數據區域」是第2步中定義的區域名稱，代表原表的A1：A21區域，以「員工編號」作爲第一列，則「員工姓名」列爲第2列，所以將第3個參數設置爲「2」。

第5步：複製公式並修改參數。複製B3裏的公式，粘貼到其他單元格，只需要修改第3個參數即可，如「年度總銷售額」位於第11列，所以第3個參數爲「11」，如下圖所示。（由於還沒有選擇員工編號，所以所有的值都爲「#N/A」）

第6步：查看結果。修改之後，我們直接在B2的下拉列表選擇員工編號，如R1009，則會在其他單元格自動顯示編號對應的其他信息。如下圖所示。

VLOOKUP用於縱向查找，如果要橫向查找，則需要用HLOOKUP函數，它的語法格式爲HLOOKUP(lookup_value,table_array,row_index_num,range_lookup)，各參數的意義與VLOOKUP類似，但是注意，第三個參數是不同的，該參數返回的是在區域中的第幾行。

建立查詢表之後，如果想抽查員工在上一年的業績情況，就很簡單方便了，這不僅實現了對數據的隨機查詢，而且簡化了原本複雜的查詢工作。這樣會對我們的工作效率很有幫助。

今天我們的主角就是VLOOKUPle，希望通過上面的操作能幫助大家提高工作效率。如果你有什麼好的意見，建議，或者有不同的看法，我都希望你留言和我們進行交流、討論。